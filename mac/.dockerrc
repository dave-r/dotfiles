#!/bin/bash

export DOCKER_ADMIN_HOST=tcp://admin-host:2376
export DOCKER_PROD_HOST=tcp://prod-host:2376
export DOCKER_DEV_HOST=tcp://dev-host:2376

export DOCKER_HOST=$DOCKER_ADMIN_HOST
# export DOCKER_TLS_VERIFY=1

export RANCHER_URL=http://rancher-host:8080/

# ssh to rancher hosts
alias sshesxi="ssh rancher@esxi-host"
alias sshadmin="ssh rancher@admin-host"
alias sshprod="ssh rancher@prod-host"
alias sshdev="ssh rancher@dev-host"

# set some docker aliases
alias dbuild="docker build"
alias dstart="docker start"
alias dstop="docker stop"
alias drm="docker rm"
alias dps="docker ps"
alias dpsa="docker ps -a"
alias dlogs="docker logs"
alias dimages="docker images"
alias drmi="docker rmi"
alias dcbuild="docker-compose build"
alias dcup="docker-compose up"
alias dcstop="docker-compose stop"
alias dclogs="docker-compose logs"
alias dcrm="docker-compose rm"
alias dmls="docker-machine ls"
alias dmstop="docker-machine stop"

# remove all unused images
function dcleanall {
	docker rmi $(docker images -q --filter 'dangling=true')
}

# get the ip address of a running container
alias dip="docker inspect --format '{{ .NetworkSettings.IPAddress }}'"

# enter a bash shell in a running container
function dexec {
	docker exec -it $1 /bin/bash
}

# start a docker host and update environment variables
function dmstart {
	docker-machine start $1
	eval "$(docker-machine env $1)"
}

# change docker client to point to admin host
function denv-admin {
	export DOCKER_HOST=$DOCKER_ADMIN_HOST
	echo "docker now points to $DOCKER_HOST"
}

# change docker client to point to prod host
function denv-prod {
	export DOCKER_HOST=$DOCKER_PROD_HOST
	echo "docker now points to $DOCKER_HOST"
}

# change docker client to point to dev host
function denv-dev {
	export DOCKER_HOST=$DOCKER_DEV_HOST
	echo "docker now points to $DOCKER_HOST"
}
